<template>
<div>
   <b-img thumbnail fluid id="areagraph" :src="require('@/assets/areachart.png')" alt="Thumbnail" v-on:click="sendAreaChartSpec"/> <!--style="max-width: 7rem;" -->
   <b-popover :target="'areagraph'"
                   :placement="'top'"
                   title="Area graph"
                   triggers="hover focus"
                   :content="'1 nominal/temporal variable and 1 quantitative variable. For multi-categories, subset by colour.'">
    </b-popover>
</div>
</template>

<script>
/* eslint-disable */
import { DataBus } from '@/main';

export default{
    data() {
        return {
           spec: {
                "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
                "description": "areaChart",
                "height": 500,  // Default height of graph
                "width": 650,   // Default width of graph, but is dynamically updated to fit the width of the device
                "autosize": {
                    "type": "fit",
                    "contains": "padding",
                    //"resize": true  //
                 },
                "data": {
                 "values": []
                 },
                "mark": {"type": "area", "line": false, "point": false},
                "encoding": {
                "x": {"field": "", "type": "temporal"},   // type can also be ordinal temporal
                "y": {"field": "", "type": "quantitative"},
                "tooltip": {"field": "", "type": "quantitative"},
                "color": {"field": "", "type": "nominal"}
                }
            } 
        }
    },
    created() {
		DataBus.$on('dataJson', (dataJson) => {  //Receive the data (array of data values) from Data component via DataBus
            this.spec.data.values = dataJson;
		});
        DataBus.$on('Y-axisValue', (yAxisSelected) => {  //Receive the y-axis value from Axis component via DataBus
            this.spec.encoding["y"]["field"] = yAxisSelected;
            //this.spec.encoding["tooltip"]["field"] = yAxisSelected; //There's a bug in the tooltip that might come from the Vuevega wrapper...
            //because it works on plain vegalite
		});
        DataBus.$on('X-axisValue', (xAxisSelected) => {  //Receive the y-axis value from Axis component via DataBus
            this.spec.encoding["x"]["field"] = xAxisSelected;
        });
        DataBus.$on('Colour', (colour) => {  //Receive the colour value from Axis component via DataBus
			this.spec.encoding["color"]["field"] = colour;
        });
	},
    methods: {
        sendAreaChartSpec() {
            DataBus.$emit('graphSchema', this.spec);
        }
    }
}

</script>

<style scoped>
div {
    cursor: pointer;
     margin-bottom: 5px;
}


</style>


